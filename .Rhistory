dim(ssd)
names(ssd[,c(-1,-2)])
names(ssd[562:563])
table(ssd$subject)
sum(table(ssd$subject))
table(ssd$activity)
sub1 <- subset(ssd,subject=1)
sub1 <- subset(ssd,subject==1)
sub1
dim(sub1)
names(sub1[1:12])
myedit("showXY.R")
showMe(1:6)
mdist <- dist(sub1[,1:3])
hclustering <- hclust(mdist)
myplclust(hclustering,lab.col = unclass(sub1$activity))
mdist <- dist(sub1[,10:12])
hclustering <- hclust(mdist)
myplclust(hclustering,lab.col = unclass(sub1$activity))
svd1 <- svd(scale(sub1[,-c(562,563)]))
dim(svd1$u)
maxCon<-which.max(svd1$v)
maxCon<-which.max(svd1$v[,2])
mdist <- dist(c(sub1[,10:12],maxCon)
mdist <- dist(c(sub1[,10:12],maxCon))
skip
mdist <- dist(sub1[,c(10:12,maxCon)])
hclustering <- hclust(mdist)
myplclust(hclustering,lab.col = unclass(sub1$activity))
play
play()
maxCon
nxt()
names(sub1[maxCon])
kClust <- kmeans(sub1[,-c(562,563)],centers = 6)
table(kClust$cluster,sub1$activity)
kClust <- kmeans(sub1[,-c(562,563)],centers = 6,nstart = 100)
table(kClust$cluster,sub1$activity)
dim(kClust$cluster)
dim(kClust$centers)
laying <- which(kClust$size==29)
plot(kClust$centers[laying,1:12],pch=19,ylab="Laying Cluster")
names(sub1[,1:3])
walkdown <- which(kClust$size==49)
plot(kClust$centers[walkdown,1:12],pch=19,ylab="Walkdown Cluster")
dim(pm0)
head(pm0)
cnames
cnames <- strsplit(cnames,"|",fixed = TRUE)
cnames
names(pm0) <- make.names(cnames[[1]][wcol])
head(pm0)
x0 <- pm0$Sample.Value
str(x0)
mean(is.na(x0))
names(pm1) <- make.names(cnames[[1]],[wcol])
names(pm1) <- make.names(cnames[[1]],[wcol]))
names(pm1) <- make.names(cnames[[1]][wcol]))
names(pm1) <- make.names(cnames[[1]][wcol])
dim(pm1)
x1 <- pm1$Sample.Value
mean(is.na(x1))
summary(x0)
summary(x1)
boxplot(x0,x1)
boxplot(log10(x0),log10(x1))
negative <- x1<0
sum(negative,na.rm = TRUE)
mean(negative,na.rm = TRUE)
dates <- pm1$Date
str(dates)
dates <- as.Date(as.character(dates),"%Y%m%d")
head(dates)
hist(dates[negative],"month")
str(site0)
both <- intersect(site0,site1)
both
head(pm0)
cnt0 <- subset(pm0,State.Code==36&county.site %in% both)
cnt1 <- subset(pm1,State.Code==36&county.site %in% both)
sapply(split(cnt0,cnt0$county.site),nrow)
sapply(split(cnt1,cnt1$county.site),nrow)
pm0sub <- subset(cnt0,County.Code==63&Site.ID==2008)
pm1sub <- subset(cnt1,County.Code==63&Site.ID==2008)
x0sub <- pm0sub$Sample.Value
x1sub <- pm1sub$Sample.Value
dates0 <- as.Date(as.character(pm0sub$Date,"%Y%m%d"))
dates0 <- as.Date(as.character(pm0sub$Date),"%Y%m%d")
dates1 <- as.Date(as.character(pm1sub$Date),"%Y%m%d")
par(mfrow=c(1,2),mar=c(4,4,2,1))
plot(dates0,x0sub,pch=20)
abline(h=median(x0sub,na.rm = ),lwd=2)
abline(h=median(x0sub,na.rm = TRUE),lwd=2)
plot(dates1,x1sub,pch=20)
abline(h=median(x1sub,na.rm = TRUE),lwd=2)
rng <- range(x0sub,x1sub,na.rm = TRUE)
rng
mn0 <- with(pm0,tapply(Sample.Value,State.Code,mean,na.rm=TRUE))
str(mn0)
mn1 <- with(pm1,tapply(Sample.Value,State.Code,mean,na.rm=TRUE))
str(mn1)
summary(mn0)
summary(mn1)
d0 <- data.frame(state = names(mn0), mean = mn0)
d1 <- data.frame(state = names(mn1), mean = mn1)
mrg <- merge(d0,d1,by="state")
play()
mn0
d1
names(mn1)
nxt()
dim(mrg)
head(mrg)
with(mrg,plot(rep(1,52),mrg[,2]),range(xlim=c(.5,2.5)))
with(mrg,plot(rep(1,52),mrg[,2]),xlim=c(.5,2.5)))
with(mrg,plot(rep(1,52),mrg[,2],xlim=c(.5,2.5)))
with(mrg,points(rep(2,52),mrg[,3]))
segments(rep(1,52),mrg[,2],rep(2,52),mrg[,3])
mrg[mrg$mean.x < mrg$mean.y,]
setwd("~/Documents/Studying/Rcourse/RepData_PeerAssessment1/RepData_PeerAssessment1")
data <- read.csv("activity.csv")
head(data)
class(data$date)
class(data$interval)
class(data$steps)
data$date <- as.Date(date,%Y:%m:%d)
data$date <- as.Date(data$date)
head(data)
class(data$date)
tapply(data$steps,data$date,sum)
data <- na.omit(data)
head(data)
View(data)
steps <- tapply(data$steps,data$date,sum)
class(steps)
steps[[3]]
steps[2]
steps <- as.data.frame(tapply(data$steps,data$date,sum))
steps
names(steps) <- c("Date","Steps_Num")
steps[,1]
steps <- aggregate(steps~date,sum)
steps <- aggregate(steps~date,data,sum)
steps
class(steps)
plot(steps$date,steps$steps,type = "h",main = "Number of Steps Per Day",xlab = "Date",ylab = "Steps Per Day",col = "red",lwd = 2)
plot(steps$date,steps$steps,type = "h",main = "Number of Steps Per Day",xlab = "Date",ylab = "Steps Per Day",col = "red",lwd = 4)
abline(mean(steps$steps),col = "blue")
abline(h = mean(steps$steps),col = "blue")
abline(h = mean(steps$steps),col = "blue",lwd = 8)
abline(h = mean(steps$steps),col = "blue",lwd = 4)
abline(h = median(steps$steps),col = "yellow",lwd = 4)
mean(steps$steps)
median(steps$steps)
inter <- aggregate(steps~interval,data,mean)
inter
head(inter)
plot(inter$interval,inter$steps,type = "l",main = "Steps at Each Interval",xlab = "Interval",ylab = "Steps",col = "Green",lwd = 2)
par(width = 480)
par(pin = (480,480))
par(pin = (480))
plot(inter$interval,inter$steps,type = "l",main = "Steps at Each Interval",xlab = "Interval",ylab = "Steps",col = "Green",lwd = 2,asp = 1)
plot(inter$interval,inter$steps,type = "l",main = "Steps at Each Interval",xlab = "Interval",ylab = "Steps",col = "Green",lwd = 2)
plot(inter$interval,inter$steps,type = "l",main = "Steps at Each Interval",xlab = "Interval",ylab = "Steps",col = "Green",lwd = 2,asp = 0.2)
plot(inter$interval,inter$steps,type = "l",main = "Steps at Each Interval",xlab = "Interval",ylab = "Steps",col = "Green",lwd = 2,asp = 5)
plot(inter$interval,inter$steps,type = "l",main = "Steps at Each Interval",xlab = "Interval",ylab = "Steps",col = "Green",lwd = 2)
par(cex=2)
plot(inter$interval,inter$steps,type = "l",main = "Steps at Each Interval",xlab = "Interval",ylab = "Steps",col = "Green",lwd = 2)
par(cex=1)
plot(inter$interval,inter$steps,type = "l",main = "Steps at Each Interval",xlab = "Interval",ylab = "Steps",col = "Green",lwd = 2)
par(cra = 480)
par(fin = (480,480))
par(fin = c(480,480))
plot(inter$interval,inter$steps,type = "l",main = "Steps at Each Interval",xlab = "Interval",ylab = "Steps",col = "Green",lwd = 2)
par(fin = c(120,120))
plot(inter$interval,inter$steps,type = "l",main = "Steps at Each Interval",xlab = "Interval",ylab = "Steps",col = "Green",lwd = 2)
par(fin = c(12,12))
plot(inter$interval,inter$steps,type = "l",main = "Steps at Each Interval",xlab = "Interval",ylab = "Steps",col = "Green",lwd = 2)
par(fin = c(2,2))
plot(inter$interval,inter$steps,type = "l",main = "Steps at Each Interval",xlab = "Interval",ylab = "Steps",col = "Green",lwd = 2)
par(fin = c(8,8))
plot(inter$interval,inter$steps,type = "l",main = "Steps at Each Interval",xlab = "Interval",ylab = "Steps",col = "Green",lwd = 2)
plot(inter$interval,inter$steps,type = "l",main = "Steps at Each Interval",xlab = "Interval",ylab = "Steps",col = "Green",lwd = 2)
par(fin = c(4,4))
plot(inter$interval,inter$steps,type = "l",main = "Steps at Each Interval",xlab = "Interval",ylab = "Steps",col = "Green",lwd = 2)
par(fin = c(3,3))
plot(inter$interval,inter$steps,type = "l",main = "Steps at Each Interval",xlab = "Interval",ylab = "Steps",col = "Green",lwd = 2)
par(fin = c(3,5))
plot(inter$interval,inter$steps,type = "l",main = "Steps at Each Interval",xlab = "Interval",ylab = "Steps",col = "Green",lwd = 2)
par(fin = c(3.4,5))
plot(inter$interval,inter$steps,type = "l",main = "Steps at Each Interval",xlab = "Interval",ylab = "Steps",col = "Green",lwd = 2)
par(fin = c(3.6,8))
plot(inter$interval,inter$steps,type = "l",main = "Steps at Each Interval",xlab = "Interval",ylab = "Steps",col = "Green",lwd = 2)
par(fin = c(3.6,6))
plot(inter$interval,inter$steps,type = "l",main = "Steps at Each Interval",xlab = "Interval",ylab = "Steps",col = "Green",lwd = 2)
par(mfrow=c(0,0,1,0))
par(mfrow=c(2,2))
plot(inter$interval,inter$steps,type = "l",main = "Steps at Each Interval",xlab = "Interval",ylab = "Steps",col = "Green",lwd = 2)
par(mfrow=c(8,8))
par(mfrow=c(1,1))
plot(inter$interval,inter$steps,type = "l",main = "Steps at Each Interval",xlab = "Interval",ylab = "Steps",col = "Green",lwd = 2)
abline(h=mean(inter$interval))
abline(h=mean(inter$interval),col = "red")
abline(h=mean(inter$steps),col = "red")
View(data)
activity <- read.csv("activity.csv")
sum(is.na(activity$steps))
View(inter)
step <- inter$steps
View(activity)
View(steps)
View(inter)
merge(activity,inter,by = "interval")
step2 <- merge(activity,inter,by = "interval")
View(step2)
naIndex <- which(is.na(step2$steps.x))
activity2 <- activity
activity2[naIndex,"steps"]=step2[naIndex,"steps.y"]
View(activity2)
activity2$steps[naIndex,] <- step2$steps.y[naIndex,]
activity2$steps[naIndex,] = step2$steps.y[naIndex,]
View(step2)
head(naIndex)
activity2$steps[naIndex] = step2$steps.y[naIndex]
activity2 <- activity
View(activity2)
View(step2)
View(inter)
View(data)
sort(step2$date)
naIndex <- which(is.na(step2$steps.x))
step2$steps.x[naIndex] = step2$steps.y[naIndex]
head(naIndex)
step3 <- aggregate(steps.x~date,step2,sum)
View(step3)
plot(step3$date,step3$steps.x,type = "h", main = "Histogram of Daily Steps(NA Imputted)",xlab = "Date", ylab = "Daily Steps",col = "Orange", lwd = 2)
plot(step3$date,step3$steps.x,type = "h", main = "Histogram of Daily Steps(NA Imputted)",xlab = "Date", ylab = "Daily Steps",col = "Orange", lwd = 2)
plot(step3$date,step3$steps.x,type = "h",main = "Number of Steps Per Day",xlab = "Date",ylab = "Steps Per Day",col = "red",lwd = 2)
plot(steps$date,steps$steps,type = "h",main = "Number of Steps Per Day",xlab = "Date",ylab = "Steps Per Day",col = "red",lwd = 2)
plot(step3$date,step3$steps.x,type = "l",main = "Number of Steps Per Day",xlab = "Date",ylab = "Steps Per Day",col = "red",lwd = 2)
plot(steps$date,steps$steps,type = "l",main = "Number of Steps Per Day",xlab = "Date",ylab = "Steps Per Day",col = "red",lwd = 2)
class(step3)
class(step3$date)
step3$date <- as.Date(step3$date)
plot(step3$date,step3$steps.x,type = "l",main = "Number of Steps Per Day",xlab = "Date",ylab = "Steps Per Day",col = "red",lwd = 2)
plot(step3$date,step3$steps.x,type = "h",main = "Number of Steps Per Day",xlab = "Date",ylab = "Steps Per Day",col = "red",lwd = 2)
step2$weekday <- weekdays(step2$date)
step2$date <- as.Date(step2$date)
step2$weekday <- weekdays(step2$date)
knitr::opts_chunk$set(echo = TRUE)
setwd("~/Documents/Studying/Rcourse/RepData_PeerAssessment1/RepData_PeerAssessment1")
data <- read.csv("activity.csv")
knitr::opts_chunk$set(echo = TRUE)
data$date <- as.Date(data$date)
data <- na.omit(data)
steps <- aggregate(steps~date,data,sum)
knitr::opts_chunk$set(echo = TRUE)
plot(steps$date,steps$steps,type = "h",main = "Number of Steps Per Day",xlab = "Date",ylab = "Steps Per Day",col = "red",lwd = 2)
abline(h = mean(steps$steps),col = "blue",lwd = 2)
abline(h = median(steps$steps),col = "green",lwd = 2)
knitr::opts_chunk$set(echo = TRUE)
paste("Mean Steps Per Day =",mean(steps$steps))
paste("Median Steps Per Day =",median(steps$steps))
knitr::opts_chunk$set(echo = TRUE)
inter <- aggregate(steps~interval,data,mean)
knitr::opts_chunk$set(echo = TRUE)
plot(inter$interval,inter$steps,type = "l",main = "Steps at Each Interval",xlab = "Interval",ylab = "Steps",col = "Green",lwd = 2)
knitr::opts_chunk$set(echo = TRUE)
paste("Interval with maximum steps =",inter$interval[which(inter$steps==max(inter$steps))])
paste("Maximum mean steps =",max(inter$steps))
knitr::opts_chunk$set(echo = TRUE)
activity <- read.csv("activity.csv")
sum(is.na(activity$steps))
knitr::opts_chunk$set(echo = TRUE)
step2 <- merge(activity,inter,by = "interval")
naIndex <- which(is.na(step2$steps.x))
activity2 <- activity
step2$steps.x[naIndex] = step2$steps.y[naIndex]
knitr::opts_chunk$set(echo = TRUE)
step3 <- aggregate(steps.x~date,step2,sum)
step3$date <- as.Date(step3$date)
plot(step3$date,step3$steps.x,type = "h",main = "Number of Steps Per Day",xlab = "Date",ylab = "Steps Per Day",col = "red",lwd = 2)
knitr::opts_chunk$set(echo = TRUE)
paste("Mean daily steps =",mean(step3$steps.x))
paste("Median daily steps =",median(step3$steps.x))
knitr::opts_chunk$set(echo = TRUE)
step2$date <- as.Date(step2$date)
step2$weekday <- weekdays(step2$date)
for(i in 1:nrow(step2)){
if (step2$weekday[i]=="Saturday"|step2$weekday[i]=="Sunday"){
step2$weeks[i]=="weekend"}
else{step2$weeks[i]=="weekday"}
}
knitr::opts_chunk$set(echo = TRUE)
step2$date <- as.Date(step2$date)
step2$weekday <- weekdays(step2$date)
for(i in 1:nrow(step2)){
if (step2$weekday[i]=="Saturday"|step2$weekday[i]=="Sunday"){
step2$weeks[i]=="weekend"}
else{step2$weeks[i]=="weekday"}
}
knitr::opts_chunk$set(echo = TRUE)
weekd <- subset(step2,weeks=="weekday")
knitr::opts_chunk$set(echo = TRUE)
step2$date <- as.Date(step2$date)
step2$weekday <- weekdays(step2$date)
for(i in 1:nrow(step2)){
if (step2$weekday[i]=="Saturday"|step2$weekday[i]=="Sunday"){
step2$weeks[i]=="weekend"}
else{step2$weeks[i]=="weekday"}
}
knitr::opts_chunk$set(echo = TRUE)
weekd <- subset(step2,weeks=="weekday")
knitr::opts_chunk$set(echo = TRUE)
step2$date <- as.Date(step2$date)
step2$weekday <- weekdays(step2$date)
step2$weeks <- rep(NA,nrow(step2))
for(i in 1:nrow(step2)){
if (step2$weekday[i]=="Saturday"|step2$weekday[i]=="Sunday"){
step2$weeks[i]=="weekend"}
else{step2$weeks[i]=="weekday"}
}
knitr::opts_chunk$set(echo = TRUE)
step2$date <- as.Date(step2$date)
step2$weekday <- weekdays(step2$date)
step2$weeks <- rep(NA,nrow(step2))
for(i in 1:nrow(step2)){
if (step2$weekday[i]=="Saturday"|step2$weekday[i]=="Sunday"){
step2$weeks[i]=="weekend"}
else{step2$weeks[i]=="weekday"}
}
knitr::opts_chunk$set(echo = TRUE)
weekd <- subset(step2,weeks=="weekday")
weeke <- subset(step2,weeks=="weekend")
sum1 <- aggregate(steps.x~interval,weekd,sum)
knitr::opts_chunk$set(echo = TRUE)
step2$date <- as.Date(step2$date)
step2$weekday <- weekdays(step2$date)
step2$weeks <- rep(NA,nrow(step2))
if (step2$weekday=="Saturday"|step2$weekday=="Sunday"){
step2$weeks=="weekend"
} else {step2$weeks=="weekday"}
knitr::opts_chunk$set(echo = TRUE)
step2$date <- as.Date(step2$date)
step2$weekday <- weekdays(step2$date)
step2$weeks <- rep(NA,nrow(step2))
for(i in 1:nrow(step2)){
if (step2$weekday[i]=="Saturday"|step2$weekday[i]=="Sunday"){
step2$weeks[i]=="weekend"
} else {step2$weeks[i]=="weekday"}
}
class(step2$weekday)
if(step2$weekday[1]=="Monday"){step2$weeks[1]=="Weekday"}
step2$weekday[1]=="Monday"
knitr::opts_chunk$set(echo = TRUE)
step2$date <- as.Date(step2$date)
step2$weekday <- weekdays(step2$date)
step2$weeks <- rep(NA,nrow(step2))
for(i in 1:nrow(step2)){
if (step2$weekday[i]=="Saturday"|step2$weekday[i]=="Sunday"){
step2$weeks[i] <- "weekend"
} else {step2$weeks[i] <- "weekday"}
}
knitr::opts_chunk$set(echo = TRUE)
weekd <- subset(step2,weeks=="weekday")
weeke <- subset(step2,weeks=="weekend")
sum1 <- aggregate(steps.x~interval,weekd,sum)
sum2 <- aggregate(steps.x~interval,weeke,sum)
par(mfrow=c(2,1))
plot1 <- plot(sum1$date,sum1$step.x,type = "l",main = "Steps by Interval - Weekday",xlab = "Interval",ylab = "Steps",lwd = 2)
View(sum1)
knitr::opts_chunk$set(echo = TRUE)
weekd <- subset(step2,weeks=="weekday")
weeke <- subset(step2,weeks=="weekend")
sum1 <- aggregate(steps.x~interval,weekd,sum)
sum2 <- aggregate(steps.x~interval,weeke,sum)
par(mfrow=c(2,1))
plot1 <- plot(sum1$interval,sum1$step.x,type = "l",main = "Steps by Interval - Weekday",xlab = "Interval",ylab = "Steps",lwd = 2)
plot1 <- plot(sum2$interval,sum2$step.x,type = "l",main = "Steps by Interval - Weekend",xlab = "Interval",ylab = "Steps",lwd = 2)
View(weekd)
View(sum2)
knitr::opts_chunk$set(echo = TRUE)
weekd <- subset(step2,weeks=="weekday")
weeke <- subset(step2,weeks=="weekend")
sum1 <- aggregate(steps.x~interval,weekd,sum)
sum2 <- aggregate(steps.x~interval,weeke,sum)
par(mfrow=c(2,1))
plot1 <- plot(sum1$interval,sum1$step.x,type = "l",main = "Steps by Interval - Weekday",xlab = "Interval",ylab = "Steps",lwd = 2)
plot1 <- plot(sum2$interval,sum2$step.x,type = "l",main = "Steps by Interval - Weekend",xlab = "Interval",ylab = "Steps",lwd = 2)
knitr::opts_chunk$set(echo = TRUE)
setwd("~/Documents/Studying/Rcourse/RepData_PeerAssessment1/RepData_PeerAssessment1")
data <- read.csv("activity.csv")
knitr::opts_chunk$set(echo = TRUE)
data$date <- as.Date(data$date)
data <- na.omit(data)
steps <- aggregate(steps~date,data,sum)
knitr::opts_chunk$set(echo = TRUE)
plot(steps$date,steps$steps,type = "h",main = "Number of Steps Per Day",xlab = "Date",ylab = "Steps Per Day",col = "red",lwd = 2)
abline(h = mean(steps$steps),col = "blue",lwd = 2)
abline(h = median(steps$steps),col = "green",lwd = 2)
knitr::opts_chunk$set(echo = TRUE)
paste("Mean Steps Per Day =",mean(steps$steps))
paste("Median Steps Per Day =",median(steps$steps))
knitr::opts_chunk$set(echo = TRUE)
inter <- aggregate(steps~interval,data,mean)
knitr::opts_chunk$set(echo = TRUE)
plot(inter$interval,inter$steps,type = "l",main = "Steps at Each Interval",xlab = "Interval",ylab = "Steps",col = "Green",lwd = 2)
knitr::opts_chunk$set(echo = TRUE)
paste("Interval with maximum steps =",inter$interval[which(inter$steps==max(inter$steps))])
paste("Maximum mean steps =",max(inter$steps))
knitr::opts_chunk$set(echo = TRUE)
activity <- read.csv("activity.csv")
sum(is.na(activity$steps))
knitr::opts_chunk$set(echo = TRUE)
step2 <- merge(activity,inter,by = "interval")
naIndex <- which(is.na(step2$steps.x))
activity2 <- activity
step2$steps.x[naIndex] = step2$steps.y[naIndex]
knitr::opts_chunk$set(echo = TRUE)
step3 <- aggregate(steps.x~date,step2,sum)
step3$date <- as.Date(step3$date)
plot(step3$date,step3$steps.x,type = "h",main = "Number of Steps Per Day",xlab = "Date",ylab = "Steps Per Day",col = "red",lwd = 2)
knitr::opts_chunk$set(echo = TRUE)
paste("Mean daily steps =",mean(step3$steps.x))
paste("Median daily steps =",median(step3$steps.x))
knitr::opts_chunk$set(echo = TRUE)
step2$date <- as.Date(step2$date)
step2$weekday <- weekdays(step2$date)
step2$weeks <- rep(NA,nrow(step2))
for(i in 1:nrow(step2)){
if (step2$weekday[i]=="Saturday"|step2$weekday[i]=="Sunday"){
step2$weeks[i] <- "weekend"
} else {step2$weeks[i] <- "weekday"}
}
knitr::opts_chunk$set(echo = TRUE)
weekd <- subset(step2,weeks=="weekday")
weeke <- subset(step2,weeks=="weekend")
sum1 <- aggregate(steps.x~interval,weekd,sum)
sum2 <- aggregate(steps.x~interval,weeke,sum)
par(mfrow=c(2,1))
plot1 <- plot(sum1$interval,sum1$step.x,type = "l",main = "Steps by Interval - Weekday",xlab = "Interval",ylab = "Steps",lwd = 2)
plot1 <- plot(sum2$interval,sum2$step.x,type = "l",main = "Steps by Interval - Weekend",xlab = "Interval",ylab = "Steps",lwd = 2)
knitr::opts_chunk$set(echo = TRUE)
setwd("~/Documents/Studying/Rcourse/RepData_PeerAssessment1/RepData_PeerAssessment1")
data <- read.csv("activity.csv")
knitr::opts_chunk$set(echo = TRUE)
data$date <- as.Date(data$date)
data <- na.omit(data)
steps <- aggregate(steps~date,data,sum)
knitr::opts_chunk$set(echo = TRUE)
setwd("~/Documents/Studying/Rcourse/RepData_PeerAssessment1/RepData_PeerAssessment1")
data <- read.csv("activity.csv")
knitr::opts_chunk$set(echo = TRUE)
data$date <- as.Date(data$date)
data <- na.omit(data)
steps <- aggregate(steps~date,data,sum)
knitr::opts_chunk$set(echo = TRUE)
setwd("~/Documents/Studying/Rcourse/RepData_PeerAssessment1/RepData_PeerAssessment1")
data <- read.csv("activity.csv")
knitr::opts_chunk$set(echo = TRUE)
data$date <- as.Date(data$date)
data <- na.omit(data)
steps <- aggregate(steps~date,data,sum)
knitr::opts_chunk$set(echo = TRUE)
plot(steps$date,steps$steps,type = "h",main = "Number of Steps Per Day",xlab = "Date",ylab = "Steps Per Day",col = "red",lwd = 2)
abline(h = mean(steps$steps),col = "blue",lwd = 2)
abline(h = median(steps$steps),col = "green",lwd = 2)
knitr::opts_chunk$set(echo = TRUE)
paste("Mean Steps Per Day =",mean(steps$steps))
paste("Median Steps Per Day =",median(steps$steps))
knitr::opts_chunk$set(echo = TRUE)
inter <- aggregate(steps~interval,data,mean)
knitr::opts_chunk$set(echo = TRUE)
plot(inter$interval,inter$steps,type = "l",main = "Steps at Each Interval",xlab = "Interval",ylab = "Steps",col = "Green",lwd = 2)
knitr::opts_chunk$set(echo = TRUE)
paste("Interval with maximum steps =",inter$interval[which(inter$steps==max(inter$steps))])
paste("Maximum mean steps =",max(inter$steps))
knitr::opts_chunk$set(echo = TRUE)
activity <- read.csv("activity.csv")
sum(is.na(activity$steps))
knitr::opts_chunk$set(echo = TRUE)
step2 <- merge(activity,inter,by = "interval")
naIndex <- which(is.na(step2$steps.x))
activity2 <- activity
step2$steps.x[naIndex] = step2$steps.y[naIndex]
knitr::opts_chunk$set(echo = TRUE)
step3 <- aggregate(steps.x~date,step2,sum)
step3$date <- as.Date(step3$date)
plot(step3$date,step3$steps.x,type = "h",main = "Number of Steps Per Day",xlab = "Date",ylab = "Steps Per Day",col = "red",lwd = 2)
knitr::opts_chunk$set(echo = TRUE)
paste("Mean daily steps =",mean(step3$steps.x))
paste("Median daily steps =",median(step3$steps.x))
knitr::opts_chunk$set(echo = TRUE)
step2$date <- as.Date(step2$date)
step2$weekday <- weekdays(step2$date)
step2$weeks <- rep(NA,nrow(step2))
for(i in 1:nrow(step2)){
if (step2$weekday[i]=="Saturday"|step2$weekday[i]=="Sunday"){
step2$weeks[i] <- "weekend"
} else {step2$weeks[i] <- "weekday"}
}
knitr::opts_chunk$set(echo = TRUE)
weekd <- subset(step2,weeks=="weekday")
weeke <- subset(step2,weeks=="weekend")
sum1 <- aggregate(steps.x~interval,weekd,mean)
sum2 <- aggregate(steps.x~interval,weeke,mean)
par(mfrow=c(2,1))
plot1 <- plot(sum1$interval,sum1$step.x,type = "l",main = "Steps by Interval - Weekday",xlab = "Interval",ylab = "Steps",lwd = 2)
plot1 <- plot(sum2$interval,sum2$step.x,type = "l",main = "Steps by Interval - Weekend",xlab = "Interval",ylab = "Steps",lwd = 2)
plot1 <- plot(sum2$interval,sum2$step.x,type = "l",main = "Steps by Interval - Weekend",xlab = "Interval",ylab = "Steps",lwd = 2)
plot1 <- plot(sum2$interval,sum2$step.x,type = "l",main = "Steps by Interval - Weekend",xlab = "Interval",ylab = "Steps",lwd = 2)
plot1 <- plot(sum1$interval,sum1$step.x,type = "l",main = "Steps by Interval - Weekday",xlab = "Interval",ylab = "Steps",lwd = 2)
